Привет. Есть задача: создать десктопное приложение.

# Условия:

1. Название проекта - electron_sqlite_multi-window.
2. Операционная система - windows(поддержка других систем не обязательна).
3. Язык программирования - JavaScript.
4. Технологии:
   1. еlectron.js - фреймворк для создавания приложения.
   2. electron-reload - для отслеживания изменений в JS, HTML и CSS файлах и автоматического обновления экрана в development-режиме.
   3. electron forge - упаковка приложения.
   4. electron-log - логирование.
      Глобальный обработчик ошибок должен ловить как ошибки в главном процессе, так и в рендерере.
   5. SQLite(sqlite3) - база данных.
      1. Миграции базы данных - простая проверка версии БД через таблицу version.
      2. Расположение БД: использовать userData.
      3. При первом запуске — создать БД, если её нет.
      4. Резервное копирование: добавить экспорт/импорт данных (на случай сбоя), формат JSON (проще для пользователя) и SQL-дамп (для разработчика).
   6. jest - тестирование.
   7. Ни каких дополнительных утилит, зависимостей, webpack, vite, bootstrap и др не использовать.
5. vscode - редактор кода.
   - eslint, prettier и т.д. не устанавливать(все необходимые плагины уже установлены).
6. Для приложения используются собственные иконки в папке assets/icons.

# Файловая структура проекта

````
electron_sqlite_multi-window/
├── config/                        # Конфигурационные файлы
│   └── forge/                     # Настройки Electron Forge
│       ├── makers.json            # Конфиг сборки под Windows
│       └── plugins.json           # Плагины Forge
│
├── docs/                          # Документация
│   ├── db_schema.md               # Схема базы данных
│   └── setup_guide.md             # Инструкция по запуску
│
├── src/                           # Исходный код приложения
│   └── assets/                    # Статические файлы
│   │   ├── data/                  # JSON-данные
│   │   │   └── nutrition_data.json
│   │   ├── icons/                 # Иконки приложения (PNG/SVG)
│   │   └── img/                   # Изображения для интерфейса
│   │
│   ├── core/                      # Общие модули ядра приложения
│   │   ├── customization.js       # API для кастомизации страниц
│   │   ├── errorHandler.js        # Глобальный обработчик ошибок
│   │   ├── helpers.js             # Вспомогательные функции (валидация, форматирование)
│   │   └── settings.js            # Управление настройками (темы, язык)
│   │
│   ├── database/                  # Работа с SQLite
│   │   ├── migrations/            # SQL-скрипты миграций
│   │   ├── backup.js              # Экспорт/импорт (JSON/SQL)
│   │   └── database.js            # Подключение/запросы к БД
│   │
│   ├── main/                      # Главный процесс Electron
│   │   ├── main.js                # Точка входа, инициализация приложения
│   │   └── windows.js             # Создание/управление окнами (роутинг)
│   │
│   ├── pages/                     # Страницы приложения
│   │   ├── cookbook/              # Рецепты
│   │   │    ├── cookbook.html
│   │   │    ├── cookbook.js
│   │   │    └── cookbook.css
│   │   ├── dashboard/             # Стартовая страница
│   │   │    ├── dashboard.html
│   │   │    ├── dashboard.js
│   │   │    └── dashboard.css
│   │   ├── nutritionSchedule/     # Расписание приёмов пищи
│   │   │    ├── nutritionSchedule.html
│   │   │    ├── nutritionSchedule.js
│   │   │    └── nutritionSchedule.css
│   │   └── nutritionTable/        # Таблица продуктов
│   │        ├── nutritionTable.html
│   │        ├── nutritionTable.js
│   │        └── nutritionTable.css
│   │
│   ├── renderer/                  # Рендер-процесс Electron
│   │   └── preload.js             # Мост между main и renderer (безопасный IPC)
│   │
│   └── styles/                    # Глобальные стили
│       ├── themes/                # Темизация
│       │   ├── light.css          # Светлая тема
│       │   └── dark.css           # Тёмная тема
│       └── global.css             # Общие стили (шрифты, reset.css)
│
├── tests/                         # Тесты (Jest)
│   ├── database/                  # Тесты БД
│   └── pages/                     # Тесты страниц
│
├── .gitignore                     # Игнорируемые файлы (node_modules, БД и т.д.)
├── README.md                      # Описание проекта, инструкции
└── package.json                   # Зависимости и скрипты (CommonJS)```
````

# Строго выполнять в течении разработки всего проекта - Принципы разработки:

1.  Модульность – код разбит на независимые логические блоки (работа с БД, рендеринг страниц, настройки). Каждая страница (dashboard, nutritionSchedule, cookbook, nutritionTable) — это отдельный модуль со своими: HTML (разметка), CSS (стили), JS (логика), database.js — отдельный модуль для работы с SQLite, windows.js — управление окнами (управление окнами).
2.  Расширяемость – новые страницы добавляются вручную (разработчиком) просто созданием папки в src/pages/ с файлами .html, .js, .css.
3.  Безопасность: все нетривиальные операции – через preload IPC.
4.  Поддержка тем оформления (светлая/тёмная) - добавить переключатель в настройках приложения, использовать CSS-переменные.
5.  СТраницы(окна). Перед разработкой каждой страницы функционал будет детализироваться.
    1.  Стартовая страница с приветствием, навигацией(функционал будет дополняться).
    2.  Страница nutritionSchedule с распределением приемов пищи на неделю для конкретного человека(функционал будет дополняться).
    3.  Страница cookbook с рецептами(функционал будет дополняться).
    4.  Страница nutritionTable с таблицей основных продуктов питания с характеристиками(функционал будет дополняться).
6.  Кастомизация:
    1.  Настройки интерфейса добавляются по мере разработки страниц.
    2.  Настройки хранятся в SQLite (`ui_settings`).
    3.  Каждая страница может расширять базовый функционал через `src/core/customization.js`.
7.  Функционал разрабатывать строго в соответствии с нашей файловой структурой(любые изменения файловой структуры - только после согласования).
8.  Доработку кода выполнять без потери уже созданного функционала(любые удаление готового функционала - только после согласования).
9.  В случае изменения кода - показывать полный обновленный код файла, в котором были произведены изменения с пояснением (что удалено(изменено, добавлено) и почему).
10. Пошаговая проверка: после каждого этапа – запуск приложения и тестирование.

# Поэтапный план разработки electron_sqlite_multi-window

1. Создать базовые .html, .js, .css для всех страниц проекта.

   1. Для файлов .html обязательно применение -
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width,initial-scale=1.0">
      <meta http-equiv="Content-Security-Policy"content="default-src 'self'; script-src 'self';style-src 'self';">
      <link rel="stylesheet" href="../../styles/globalcss">
      <link rel="stylesheet" href="./название файла.css">
   </head>
   <body><h1>Приветствие с названием страницы</h1></body>)

   2. Создать общие стили в src/styles/global.css
   3. Создание стартового окна (dashboard)
      - src/pages/dashboard/ с dashboard.html, dashboard.js, dashboard.css.
      - Добавить базовую разметку с навигацией.
      - Добавить базовую разметку со списком клиентов.
      - Добавить базовую разметку с поиском, сортировкой клиентов.
      - Для .js - лог с приветсвием на странице
   4. Создание nutritionTable (таблица продуктов)
      - src/pages/nutritionTable/ с nutritionTable.html, nutritionTable.js, nutritionTable.css.
      - Добавить базовую разметку с формой добавления продуктов
      - Добавить базовую разметку с таблицей продуктов
      - Добавить базовую разметку для поиска, сортировки и фильтрации продуктов по категориям.
      - Для .js - лог с приветсвием на странице
   5. Создание cookbook (рецепты)
      - src/pages/cookbook/ с cookbook.html, cookbook.js, cookbook.css.
      - Добавить базовую разметку с формой добавления рецептов
      - Добавить базовую разметку для списка рецептов.
      - Добавить базовую разметку для поиска, сортировки и фильтрации рецептов по категориям.
      - Для .js - лог с приветсвием на странице
   6. Создание nutritionSchedule (расписание питания)
      - src/pages/nutritionSchedule/ с nutritionSchedule.html, nutritionSchedule.js, nutritionSchedule.css.
      - Добавить базовую разметку с формой для планирования питания.
      - Для .js - лог с приветсвием на странице
   7. Переключение тем оформления
      - Реализовать переключатель тем в src/core/settings.js.
      - Добавить CSS-переменные в src/styles/themes/.

2. Инициализация проекта

   1. Создание файловой структуры
   2. Инициализация package.json
      - npm init -y → затем вручную скорректировать:
        "name": "electron_sqlite_multi-window"
        "license": "MIT"
        "author": "Martin937"
        "type": "commonjs"
        "main": "src/main/main.js"
   3. Установить зависимости

      - npm install electron electron-reload electron-log sqlite3
      - npm install @electron-forge/cli jest -D
      - npx electron-forge import

   4. Настройка Electron
      - Создать src/main/main.js (точка входа).
      - Добавить src/main/windows.js для управления окнами.
      - Создать src/renderer/preload.js (безопасный IPC-мост).

3. Работа с базой данных SQLite

   1. Инициализация базы данных

      - src/database/database.js — создание подключения.
      - Проверка версии БД через таблицу version.

   2. Реализация миграций

      - src/database/migrations/ — SQL-файлы для структуры БД.
      - Добавить код для автоматического выполнения миграций.

   3. Функции работы с данными
      - Создать CRUD-методы в src/database/database.js (например, getRecipes, addRecipe и т. д.).
      - Написать unit-тесты для работы с БД в tests/database/.

4. Реализация nutritionTable (таблица продуктов)

   1. Разметка и стили
      - Редактировать src/pages/nutritionTable/ с nutritionTable.html, nutritionTable.js, nutritionTable.css.
   2. Логика рендеринга
      - Настроить загрузку данных и динамическое обновление контента.
      - Реализовать поиск, фильтрацию, сортировку.
   3. Работа с БД
      - Обеспечить взаимодействие с БД.

5. Реализация cookbook (рецепты)

   1. Разметка и стили
      - Редактировать src/pages/cookbook/ с cookbook.html, cookbook.js, cookbook.css.
   2. Логика рендеринга
      - Настроить загрузку данных и динамическое обновление контента.
      - Реализовать поиск, фильтрацию, сортировку.
   3. Работа с БД
      - Обеспечить взаимодействие с БД.

6. Реализация стартового окна (dashboard)

   1. Разметка и стили
      - Редактировать src/pages/dashboard/ с dashboard.html, dashboard.js, dashboard.css.
   2. Логика рендеринга
      - Настроить загрузку данных и динамическое обновление контента.
   3. Переключение тем оформления
      - Реализовать переключатель тем в src/core/settings.js.
      - Добавить CSS-переменные в src/styles/themes/.
   4. Логика рендеринга
      - Настроить загрузку данных и динамическое обновление контента.
      - Реализовать поиск, сортировку.
   5. Работа с БД
      - Обеспечить взаимодействие с БД.

7. Реализация nutritionSchedule (расписание питания)

   1. Разметка и стили
      - Редактировать src/pages/nutritionSchedule/ с nutritionSchedule.html, nutritionSchedule.js, nutritionSchedule.css.
   2. Логика рендеринга
      - Настроить загрузку данных и динамическое обновление контента.
   3. Работа с БД
      - Обеспечить взаимодействие с БД.

8. Резервное копирование данных

   1. src/database/backup.js — экспорт/импорт данных в JSON и SQL-дамп.
   2. Добавить UI-элементы для создания резервных копий.

9. Улучшение UX и тестирование

   1. Финальная проверка логики.
   2. Тестирование с помощью Jest.
   3. Оптимизация производительности.

10. Сборка и упаковка
11. Проверка настроек config/forge/makers.json.
12. Сборка npx electron-forge make.
13. Генерация установщика.

## Задание 1

1. Изучи условия, файловую структуру проекта, принципы разработки и прими к выполнению.
2. Создай код "scripts": {}, для файла package.json с учетом использования electron electron-reload electron-log sqlite3 electron-forge jest.
3. Создай код для файла .gitignore с учетом нашей конфигурации(избегать излишней конфигурации)
4. Создай документацию для проекта.
5. После изучения я представлю поэтапный план разработки

## Задание 2

Вот поэтапный план разработки
Изучи его. Как будешь готов, продолжим

## Задание 3

Проект инициализирован. Все npm зависимости установлены. Файловая структура создана. Базовые .html, .js, .css созданы. Переходим к реализации пункта 2.4 и 3.

Базовый функционал настроен

## Задание 4

### План реализации nutritionTable

1.  Интерфейс (src/pages/nutritionTable/)

    1. Добавить:
       - Кнопка "Импорт" (с подтверждением)
       - Кнопка "Экспорт"
       - Модальное окно CRUD операций
    2. Удалить:
       - Поле фильтрации (заменим на отдельный фильтр)
    3. Изменить:
       - Адаптивная таблица с:
         - Иконками действий (✏️, 🗑️)
         - Горизонтальным скроллом
         - Индикаторами сортировки (▲/▼)
    4. Доработать стили:
       - Кнопки («Добавить», «Импорт»)
       - Поле поиска с autocomplete
       - сохранить стиль оформления

2.  Данные и БД

    1.  Файл src/assets/data/nutrition_data.json — только для первичного импорта.
    2.  Структура данных nutrition_data.json -
        {
        "Овощи": [
        {
        "Название": "Картофель (вареный)",
        "Калорийность": 77,
        "Белки": 2,
        "Жиры": 0.1,
        "Углеводы": 17,
        "Витамины": ["С", "В6"],
        "Минералы": ["Калий", "магний"]
        },
        ...
        ],
        "Фрукты": [ {...}, ... ],
        "Зерновые и крупы": [ {...}, ... ],
        "Мука и мучные изделия": [ {...}, ... ],
        "Молочные продукты": [ {...}, ... ],
        "Мясо и птица": [ {...}, ... ],
        "Рыба и морепродукты": [ {...}, ... ],
        }

        ```// Формат хранения в SQLite:
        {
        id: INTEGER PK,
        name: TEXT NOT NULL,       // "Картофель (вареный)"
        category: TEXT NOT NULL,   // "Овощи"
        calories: REAL,            // 77
        proteins: REAL,            // 2
        fats: REAL,                // 0.1
        carbs: REAL,               // 17
        vitamins: TEXT,            // JSON: ["С","В6"]
        minerals: TEXT,            // JSON: ["Калий","Магний"]
        created_at: TIMESTAMP
        }
        ```

    3.  Обновить структуру БД (миграция 003_enhance_products.sql) на основе структуры nutrition_data.json

3.  Оптимизации

    - Для массива витаминов/минералов используем JSON.stringify/parse

4.  Функционал

    1. Загрузка данных

       - Кнопка «Импорт» → загружает данные из файла src/assets/data/nutrition_data.json в БД (с подтверждением).
       - Кнопка «Добавить» → открывает модальное окно с формой.
       - Кнопка «Экспорт» → экспорт в CSV.

    2. Управление данными

       - Добавление/редактирование: через модальное окно (не inline)
       - Валидация
         - Числовые поля > 0 (калории, белки и т.д.).
         - Обязательные поля: название, категория.

    3. Поиск и сортировка

       - Поиск: по названию (полнотекстовый FTS5) и категории
       - Сортировка:
         - Клик по заголовку (▲/▼).
         - Поддержка: все поля таблицы.

    4. Фильтрация
       - Чекбоксы для категорий (овощи, фрукты и т.д.).
       - Слайдеры для диапазонов (калории: 50–100 ккал).

5.  Интеграция

    1. IPC-методы (preload.js):
       - getProducts: (filters) => ipcRenderer.invoke('get-products', filters),
         importSampleData: (override) => ipcRenderer.invoke('import-sample-data', override)
    2. Сервис (ProductsManager.js):
       - importFromJson() — загрузка данных из JSON.
       - getAllWithFilters() — поиск/фильтрация.
       - updateProduct() — обновление с валидацией.

6.  Дополнительно

    1. Пагинация таблицы (если продуктов > 100).
    2. Подтверждение для опасных действий (удаление, импорт).

7.  Контрольные точки

    1. Тесты для:
       1. Импорта данных (проверка кол-ва записей)
       2. Валидации (отрицательные значения)
       3. Сортировки (по всем полям)
       4. Фильтрации (комбинированные условия)

## Задание 5

## Задание 6

## Задание 7

<!-- -------------------- -->

<!-- -------------------- -->

<!-- -------------------- -->

<!-- -------------------- -->

npm init -y # Инициализация package.json
npm install electron electron-reload electron-log sqlite3 # Основные зависимости
npm install @electron-forge/cli jest -D # Dev-зависимости
npx electron-forge import # Импорт настроек Electron Forge

```

rm ~/AppData/Roaming/electron_sqlite_multi-window-d/nutrition.db

```

```
 "start": "set NODE_ENV=development&&electron --enable-logging .",
```
